(function(e){if(typeof e.fn.each2=="undefined"){e.fn.extend({each2:function(t){var n=e([0]),r=-1,i=this.length;while(++r<i&&(n.context=n[0]=this[r])&&t.call(n[0],r,n)!==false);return this}})}})(jQuery);(function(e,t){"use strict";function l(e,t){var n=0,r=t.length;for(;n<r;n=n+1)if(e===t[n])return n;return-1}function c(e,t){return e===t}function h(t,n){var r,i,s;if(t===null||t.length<1)return[];r=t.split(n);for(i=0,s=r.length;i<s;i=i+1)r[i]=e.trim(r[i]);return r}function p(e){return e.outerWidth(false)-e.width()}function d(n){var r="keyup-change-value";n.bind("keydown",function(){if(e.data(n,r)===t){e.data(n,r,n.val())}});n.bind("keyup",function(){var i=e.data(n,r);if(i!==t&&n.val()!==i){e.removeData(n,r);n.trigger("keyup-change")}})}function v(n){n.bind("mousemove",function(n){var r=a;if(r===t||r.x!==n.pageX||r.y!==n.pageY){e(n.target).trigger("mousemove-filtered",n)}})}function m(e,n,r){r=r||t;var i;return function(){var t=arguments;window.clearTimeout(i);i=window.setTimeout(function(){n.apply(r,t)},e)}}function g(e){var t=false,n;return function(){if(t===false){n=e();t=true}return n}}function y(e,t){var n=m(e,function(e){t.trigger("scroll-debounced",e)});t.bind("scroll",function(e){if(l(e.target,t.get())>=0)n(e)})}function b(e){if(e[0]===document.activeElement)return;window.setTimeout(function(){var t=e[0],n=e.val().length,r;e.focus();if(t.setSelectionRange){t.setSelectionRange(n,n)}else if(t.createTextRange){r=t.createTextRange();r.collapse(true);r.moveEnd("character",n);r.moveStart("character",n);r.select()}},0)}function w(e){e.preventDefault();e.stopPropagation()}function E(e){e.preventDefault();e.stopImmediatePropagation()}function S(t){if(!u){var n=t[0].currentStyle||window.getComputedStyle(t[0],null);u=e(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:n.fontSize,fontFamily:n.fontFamily,fontStyle:n.fontStyle,fontWeight:n.fontWeight,letterSpacing:n.letterSpacing,textTransform:n.textTransform,whiteSpace:"nowrap"});u.attr("class","select2-sizer");e("body").append(u)}u.text(t.val());return u.width()}function x(t,n,r){var i,s=[],o;i=t.attr("class");if(typeof i==="string"){e(i.split(" ")).each2(function(){if(this.indexOf("select2-")===0){s.push(this)}})}i=n.attr("class");if(typeof i==="string"){e(i.split(" ")).each2(function(){if(this.indexOf("select2-")!==0){o=r(this);if(typeof o==="string"&&o.length>0){s.push(this)}}})}t.attr("class",s.join(" "))}function T(e,t,n,r){var i=e.toUpperCase().indexOf(t.toUpperCase()),s=t.length;if(i<0){n.push(r(e));return}n.push(r(e.substring(0,i)));n.push("<span class='select2-match'>");n.push(r(e.substring(i,i+s)));n.push("</span>");n.push(r(e.substring(i+s,e.length)))}function N(t){var n,r=0,i=null,s=t.quietMillis||100;return function(o){window.clearTimeout(n);n=window.setTimeout(function(){r+=1;var n=r,s=t.data,u=t.url,a=t.transport||e.ajax,f=t.type||"GET",l={};s=s?s.call(this,o.term,o.page,o.context):null;u=typeof u==="function"?u.call(this,o.term,o.page,o.context):u;if(null!==i){i.abort()}if(t.params){if(e.isFunction(t.params)){e.extend(l,t.params.call(null))}else{e.extend(l,t.params)}}e.extend(l,{url:u,dataType:t.dataType,data:s,type:f,cache:false,success:function(e){if(n<r){return}var i=t.results(e,o.page);o.callback(i)}});i=a.call(null,l)},s)}}function C(t){var n=t,r,i=function(e){return""+e.text};if(!e.isArray(n)){i=n.text;if(!e.isFunction(i)){r=n.text;i=function(e){return e[r]}}n=n.results}return function(t){var r=t.term,s={results:[]},o;if(r===""){t.callback({results:n});return}o=function(n,s){var u,a;n=n[0];if(n.children){u={};for(a in n){if(n.hasOwnProperty(a))u[a]=n[a]}u.children=[];e(n.children).each2(function(e,t){o(t,u.children)});if(u.children.length||t.matcher(r,i(u),n)){s.push(u)}}else{if(t.matcher(r,i(n),n)){s.push(n)}}};e(n).each2(function(e,t){o(t,s.results)});t.callback(s)}}function k(n){var r=e.isFunction(n);return function(i){var s=i.term,o={results:[]};e(r?n():n).each(function(){var e=this.text!==t,n=e?this.text:this;if(s===""||i.matcher(s,n)){o.results.push(e?this:{id:this,text:this})}});i.callback(o)}}function L(t,n){if(e.isFunction(t))return true;if(!t)return false;throw new Error("formatterName must be a function or a falsy value")}function A(t){return e.isFunction(t)?t():t}function O(t){var n=0;e.each(t,function(e,t){if(t.children){n+=O(t.children)}else{n++}});return n}function M(e,n,r,i){var s=e,o=false,u,a,f,l,h;if(!i.createSearchChoice||!i.tokenSeparators||i.tokenSeparators.length<1)return t;while(true){a=-1;for(f=0,l=i.tokenSeparators.length;f<l;f++){h=i.tokenSeparators[f];a=e.indexOf(h);if(a>=0)break}if(a<0)break;u=e.substring(0,a);e=e.substring(a+h.length);if(u.length>0){u=i.createSearchChoice(u,n);if(u!==t&&u!==null&&i.id(u)!==t&&i.id(u)!==null){o=false;for(f=0,l=n.length;f<l;f++){if(c(i.id(u),i.id(n[f]))){o=true;break}}if(!o)r(u)}}}if(s!==e)return e}function _(t,n){var r=function(){};r.prototype=new t;r.prototype.constructor=r;r.prototype.parent=t.prototype;r.prototype=e.extend(r.prototype,n);return r}if(window.Select2!==t){return}var n,r,i,s,o,u,a,f;n={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(e){e=e.which?e.which:e;switch(e){case n.LEFT:case n.RIGHT:case n.UP:case n.DOWN:return true}return false},isControl:function(e){var t=e.which;switch(t){case n.SHIFT:case n.CTRL:case n.ALT:return true}if(e.metaKey)return true;return false},isFunctionKey:function(e){e=e.which?e.which:e;return e>=112&&e<=123}};f=e(document);o=function(){var e=1;return function(){return e++}}();f.bind("mousemove",function(e){a={x:e.pageX,y:e.pageY}});r=_(Object,{bind:function(e){var t=this;return function(){e.apply(t,arguments)}},init:function(n){var r,i,s=".select2-results",u;this.opts=n=this.prepareOpts(n);this.id=n.id;if(n.element.data("select2")!==t&&n.element.data("select2")!==null){this.destroy()}this.enabled=true;this.container=this.createContainer();this.containerId="s2id_"+(n.element.attr("id")||"autogen"+o());this.containerSelector="#"+this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1");this.container.attr("id",this.containerId);this.body=g(function(){return n.element.closest("body")});u=e("#select2-drop-mask");if(u.length==0){u=e(document.createElement("div"));u.attr("id","select2-drop-mask").attr("class","select2-drop-mask");u.hide();u.appendTo(this.body());u.bind("mousedown touchstart",function(t){var n=e("#select2-drop"),r;if(n.length>0){r=n.data("select2");if(r.opts.selectOnBlur){r.selectHighlighted({noFocus:true})}r.close()}})}x(this.container,this.opts.element,this.opts.adaptContainerCssClass);this.container.css(A(n.containerCss));this.container.addClass(A(n.containerCssClass));this.elementTabIndex=this.opts.element.attr("tabIndex");this.opts.element.data("select2",this).addClass("select2-offscreen").bind("focus.select2",function(){e(this).select2("focus")}).attr("tabIndex","-1").before(this.container);this.container.data("select2",this);this.dropdown=this.container.find(".select2-drop");this.dropdown.addClass(A(n.dropdownCssClass));this.dropdown.data("select2",this);this.results=r=this.container.find(s);this.search=i=this.container.find("input.select2-input");i.attr("tabIndex",this.elementTabIndex);this.resultsPage=0;this.context=null;this.initContainer();this.initContainerWidth();v(this.results);this.dropdown.delegate(s,"mousemove-filtered",this.bind(this.highlightUnderEvent));y(80,this.results);this.dropdown.delegate(s,"scroll-debounced",this.bind(this.loadMoreIfNeeded));if(e.fn.mousewheel){r.mousewheel(function(e,t,n,i){var s=r.scrollTop(),o;if(i>0&&s-i<=0){r.scrollTop(0);w(e)}else if(i<0&&r.get(0).scrollHeight-r.scrollTop()+i<=r.height()){r.scrollTop(r.get(0).scrollHeight-r.height());w(e)}})}d(i);i.bind("keyup-change input paste",this.bind(this.updateResults));i.bind("focus",function(){i.addClass("select2-focused")});i.bind("blur",function(){i.removeClass("select2-focused")});this.dropdown.delegate(s,"mouseup",this.bind(function(t){if(e(t.target).closest(".select2-result-selectable").length>0){this.highlightUnderEvent(t);this.selectHighlighted(t)}else{this.focusSearch()}w(t)}));this.dropdown.bind("click mouseup mousedown",function(e){e.stopPropagation()});if(e.isFunction(this.opts.initSelection)){this.initSelection();this.monitorSource()}if(n.element.is(":disabled")||n.element.is("[readonly='readonly']"))this.disable()},destroy:function(){var e=this.opts.element.data("select2");if(this.propertyObserver){delete this.propertyObserver;this.propertyObserver=null}if(e!==t){e.container.remove();e.dropdown.remove();e.opts.element.removeClass("select2-offscreen").removeData("select2").unbind(".select2").attr({tabIndex:this.elementTabIndex}).show()}},prepareOpts:function(n){var r,i,s,o;r=n.element;if(r.get(0).tagName.toLowerCase()==="select"){this.select=i=n.element}if(i){e.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in n){throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}})}n=e.extend({},{populateResults:function(r,i,s){var o,u,a,f,l=this.opts.id,c=this;o=function(r,i,u){var a,f,h,p,d,v,m,g,y,b;r=n.sortResults(r,i,s);for(a=0,f=r.length;a<f;a=a+1){h=r[a];d=h.disabled===true;p=!d&&l(h)!==t;v=h.children&&h.children.length>0;m=e("<li></li>");m.addClass("select2-results-dept-"+u);m.addClass("select2-result");m.addClass(p?"select2-result-selectable":"select2-result-unselectable");if(d){m.addClass("select2-disabled")}if(v){m.addClass("select2-result-with-children")}m.addClass(c.opts.formatResultCssClass(h));g=e(document.createElement("div"));g.addClass("select2-result-label");b=n.formatResult(h,g,s,c.opts.escapeMarkup);if(b!==t){g.html(b)}m.append(g);if(v){y=e("<ul></ul>");y.addClass("select2-result-sub");o(h.children,y,u+1);m.append(y)}m.data("select2-data",h);i.append(m)}};o(i,r,0)}},e.fn.select2.defaults,n);if(typeof n.id!=="function"){s=n.id;n.id=function(e){return e[s]}}if(e.isArray(n.element.data("select2Tags"))){if("tags"in n){throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+n.element.attr("id")}n.tags=n.element.attr("data-select2-tags")}if(i){n.query=this.bind(function(n){var i={results:[],more:false},s=n.term,o,u,a;a=function(e,t){var r;if(e.is("option")){if(n.matcher(s,e.text(),e)){t.push({id:e.attr("value")||e.text(),text:e.text(),element:e.get(),css:e.attr("class"),disabled:c(e.attr("disabled"),"disabled")})}}else if(e.is("optgroup")){r={text:e.attr("label"),children:[],element:e.get(),css:e.attr("class")};e.children().each2(function(e,t){a(t,r.children)});if(r.children.length>0){t.push(r)}}};o=r.children();if(this.getPlaceholder()!==t&&o.length>0){u=o[0];if(e(u).text()===""){o=o.not(u)}}o.each2(function(e,t){a(t,i.results)});n.callback(i)});n.id=function(e){return e.id};n.formatResultCssClass=function(e){return e.css}}else{if(!("query"in n)){if("ajax"in n){o=n.element.data("ajax-url");if(o&&o.length>0){n.ajax.url=o}n.query=N(n.ajax)}else if("data"in n){n.query=C(n.data)}else if("tags"in n){n.query=k(n.tags);if(n.createSearchChoice===t){n.createSearchChoice=function(e){return{id:e,text:e}}}if(n.initSelection===t){n.initSelection=function(t,r){var i=[];e(h(t.val(),n.separator)).each(function(){var t=this,r=this,s=n.tags;if(e.isFunction(s))s=s();e(s).each(function(){if(c(this.id,t)){r=this.text;return false}});i.push({id:t,text:r})});r(i)}}}}}if(typeof n.query!=="function"){throw"query function not defined for Select2 "+n.element.attr("id")}return n},monitorSource:function(){var e=this.opts.element,t;e.bind("change.select2",this.bind(function(e){if(this.opts.element.data("select2-change-triggered")!==true){this.initSelection()}}));t=this.bind(function(){var e,t,n=this;e=this.opts.element.attr("disabled")!=="disabled";t=this.opts.element.attr("readonly")==="readonly";e=e&&!t;if(this.enabled!==e){if(e){this.enable()}else{this.disable()}}x(this.container,this.opts.element,this.opts.adaptContainerCssClass);this.container.addClass(A(this.opts.containerCssClass));x(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass);this.dropdown.addClass(A(this.opts.dropdownCssClass))});e.bind("propertychange.select2 DOMAttrModified.select2",t);if(typeof WebKitMutationObserver!=="undefined"){if(this.propertyObserver){delete this.propertyObserver;this.propertyObserver=null}this.propertyObserver=new WebKitMutationObserver(function(e){e.forEach(t)});this.propertyObserver.observe(e.get(0),{attributes:true,subtree:false})}},triggerChange:function(t){t=t||{};t=e.extend({},t,{type:"change",val:this.val()});this.opts.element.data("select2-change-triggered",true);this.opts.element.trigger(t);this.opts.element.data("select2-change-triggered",false);this.opts.element.click();if(this.opts.blurOnChange)this.opts.element.blur()},enable:function(){if(this.enabled)return;this.enabled=true;this.container.removeClass("select2-container-disabled");this.opts.element.removeAttr("disabled")},disable:function(){if(!this.enabled)return;this.close();this.enabled=false;this.container.addClass("select2-container-disabled");this.opts.element.attr("disabled","disabled")},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var t=this.container.offset(),n=this.container.outerHeight(false),r=this.container.outerWidth(false),i=this.dropdown.outerHeight(false),s=e(window).scrollLeft()+e(window).width(),o=e(window).scrollTop()+e(window).height(),u=t.top+n,a=t.left,f=u+i<=o,l=t.top-i>=this.body().scrollTop(),c=this.dropdown.outerWidth(false),h=a+c<=s,p=this.dropdown.hasClass("select2-drop-above"),d,v,m;if(this.body().css("position")!=="static"){d=this.body().offset();u-=d.top;a-=d.left}if(p){v=true;if(!l&&f)v=false}else{v=false;if(!f&&l)v=true}if(!h){a=t.left+r-c}if(v){u=t.top-i;this.container.addClass("select2-drop-above");this.dropdown.addClass("select2-drop-above")}else{this.container.removeClass("select2-drop-above");this.dropdown.removeClass("select2-drop-above")}m=e.extend({top:u,left:a,width:r},A(this.opts.dropdownCss));this.dropdown.css(m)},shouldOpen:function(){var t;if(this.opened())return false;t=e.Event("opening");this.opts.element.trigger(t);return!t.isDefaultPrevented()},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above");this.dropdown.removeClass("select2-drop-above")},open:function(){if(!this.shouldOpen())return false;window.setTimeout(this.bind(this.opening),1);return true},opening:function(){var t=this.containerId,n="scroll."+t,r="resize."+t,i="orientationchange."+t,s;this.clearDropdownAlignmentPreference();this.container.addClass("select2-dropdown-open").addClass("select2-container-active");if(this.dropdown[0]!==this.body().children().last()[0]){this.dropdown.detach().appendTo(this.body())}this.updateResults(true);s=e("#select2-drop-mask");if(this.dropdown.prev()[0]!==s[0]){this.dropdown.before(s)}e("#select2-drop").removeAttr("id");this.dropdown.attr("id","select2-drop");s.css({width:document.documentElement.scrollWidth,height:document.documentElement.scrollHeight});s.show();this.dropdown.show();this.positionDropdown();this.dropdown.addClass("select2-drop-active");this.ensureHighlightVisible();this.container.parents().add(window).each(function(){e(this).bind(r+" "+n+" "+i,function(t){e("#select2-drop-mask").css({width:document.documentElement.scrollWidth,height:document.documentElement.scrollHeight});e("#select2-drop").data("select2").positionDropdown()})});this.focusSearch()},close:function(){if(!this.opened())return;var t=this.containerId,n="scroll."+t,r="resize."+t,i="orientationchange."+t;this.container.parents().add(window).each(function(){e(this).unbind(n).unbind(r).unbind(i)});this.clearDropdownAlignmentPreference();e("#select2-drop-mask").hide();this.dropdown.removeAttr("id");this.dropdown.hide();this.container.removeClass("select2-dropdown-open");this.results.empty();this.clearSearch();this.opts.element.trigger(e.Event("close"))},clearSearch:function(){},getMaximumSelectionSize:function(){return A(this.opts.maximumSelectionSize)},ensureHighlightVisible:function(){var t=this.results,n,r,i,s,o,u,a;r=this.highlight();if(r<0)return;if(r==0){t.scrollTop(0);return}n=this.findHighlightableChoices();i=e(n[r]);s=i.offset().top+i.outerHeight(true);if(r===n.length-1){a=t.find("li.select2-more-results");if(a.length>0){s=a.offset().top+a.outerHeight(true)}}o=t.offset().top+t.outerHeight(true);if(s>o){t.scrollTop(t.scrollTop()+(s-o))}u=i.offset().top-t.offset().top;if(u<0&&i.css("display")!="none"){t.scrollTop(t.scrollTop()+u)}},findHighlightableChoices:function(){var e=this.results.find(".select2-result-selectable:not(.select2-selected):not(.select2-disabled)");return this.results.find(".select2-result-selectable:not(.select2-selected):not(.select2-disabled)")},moveHighlight:function(t){var n=this.findHighlightableChoices(),r=this.highlight();while(r>-1&&r<n.length){r+=t;var i=e(n[r]);if(i.hasClass("select2-result-selectable")&&!i.hasClass("select2-disabled")&&!i.hasClass("select2-selected")){this.highlight(r);break}}},highlight:function(t){var n=this.findHighlightableChoices(),r,i;if(arguments.length===0){return l(n.filter(".select2-highlighted")[0],n.get())}if(t>=n.length)t=n.length-1;if(t<0)t=0;this.results.find(".select2-highlighted").removeClass("select2-highlighted");r=e(n[t]);r.addClass("select2-highlighted");this.ensureHighlightVisible();i=r.data("select2-data");if(i){this.opts.element.trigger({type:"highlight",val:this.id(i),choice:i})}},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(t){var n=e(t.target).closest(".select2-result-selectable");if(n.length>0&&!n.is(".select2-highlighted")){var r=this.findHighlightableChoices();this.highlight(r.index(n))}else if(n.length==0){this.results.find(".select2-highlighted").removeClass("select2-highlighted")}},loadMoreIfNeeded:function(){var e=this.results,t=e.find("li.select2-more-results"),n,r=-1,i=this.resultsPage+1,s=this,o=this.search.val(),u=this.context;if(t.length===0)return;n=t.offset().top-e.offset().top-e.height();if(n<=this.opts.loadMorePadding){t.addClass("select2-active");this.opts.query({element:this.opts.element,term:o,page:i,context:u,matcher:this.opts.matcher,callback:this.bind(function(n){if(!s.opened())return;s.opts.populateResults.call(this,e,n.results,{term:o,page:i,context:u});if(n.more===true){t.detach().appendTo(e).text(s.opts.formatLoadMore(i+1));window.setTimeout(function(){s.loadMoreIfNeeded()},10)}else{t.remove()}s.positionDropdown();s.resultsPage=i;s.context=n.context})})}},tokenize:function(){},updateResults:function(n){function f(){i.scrollTop(0);r.removeClass("select2-active");u.positionDropdown()}function l(e){i.html(e);f()}var r=this.search,i=this.results,s=this.opts,o,u=this,a;if(n!==true&&(this.showSearchInput===false||!this.opened())){return}r.addClass("select2-active");var h=this.getMaximumSelectionSize();if(h>=1){o=this.data();if(e.isArray(o)&&o.length>=h&&L(s.formatSelectionTooBig,"formatSelectionTooBig")){l("<li class='select2-selection-limit'>"+s.formatSelectionTooBig(h)+"</li>");return}}if(r.val().length<s.minimumInputLength){if(L(s.formatInputTooShort,"formatInputTooShort")){l("<li class='select2-no-results'>"+s.formatInputTooShort(r.val(),s.minimumInputLength)+"</li>")}else{l("")}return}else if(s.formatSearching()&&n===true){l("<li class='select2-searching'>"+s.formatSearching()+"</li>")}if(s.maximumInputLength&&r.val().length>s.maximumInputLength){if(L(s.formatInputTooLong,"formatInputTooLong")){l("<li class='select2-no-results'>"+s.formatInputTooLong(r.val(),s.maximumInputLength)+"</li>")}else{l("")}return}a=this.tokenize();if(a!=t&&a!=null){r.val(a)}this.resultsPage=1;s.query({element:s.element,term:r.val(),page:this.resultsPage,context:null,matcher:s.matcher,callback:this.bind(function(o){var a;if(!this.opened())return;this.context=o.context===t?null:o.context;if(this.opts.createSearchChoice&&r.val()!==""){a=this.opts.createSearchChoice.call(null,r.val(),o.results);if(a!==t&&a!==null&&u.id(a)!==t&&u.id(a)!==null){if(e(o.results).filter(function(){return c(u.id(this),u.id(a))}).length===0){o.results.unshift(a)}}}if(o.results.length===0&&L(s.formatNoMatches,"formatNoMatches")){l("<li class='select2-no-results'>"+s.formatNoMatches(r.val())+"</li>");return}i.empty();u.opts.populateResults.call(this,i,o.results,{term:r.val(),page:this.resultsPage,context:null});if(o.more===true&&L(s.formatLoadMore,"formatLoadMore")){i.append("<li class='select2-more-results'>"+u.opts.escapeMarkup(s.formatLoadMore(this.resultsPage))+"</li>");window.setTimeout(function(){u.loadMoreIfNeeded()},10)}this.postprocessResults(o,n);f()})})},cancel:function(){this.close()},blur:function(){if(this.opts.selectOnBlur)this.selectHighlighted({noFocus:true});this.close();this.container.removeClass("select2-container-active");if(this.search[0]===document.activeElement){this.search.blur()}this.clearSearch();this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){b(this.search)},selectHighlighted:function(e){var t=this.highlight(),n=this.results.find(".select2-highlighted"),r=n.closest(".select2-result").data("select2-data");if(r){this.highlight(t);this.onSelect(r,e)}},getPlaceholder:function(){if(this.select){if(this.select.find("option").first().text()!==""){return t}}return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder},initContainerWidth:function(){function n(){var n,r,i,s,o;if(this.opts.width==="off"){return null}else if(this.opts.width==="element"){return this.opts.element.outerWidth(false)===0?"auto":this.opts.element.outerWidth(false)+"px"}else if(this.opts.width==="copy"||this.opts.width==="resolve"){n=this.opts.element.attr("style");if(n!==t){r=n.split(";");for(s=0,o=r.length;s<o;s=s+1){i=r[s].replace(/\s/g,"").match(/width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/);if(i!==null&&i.length>=1)return i[1]}}if(this.opts.width==="resolve"){n=this.opts.element.css("width");if(n.indexOf("%")>0)return n;return this.opts.element.outerWidth(false)===0?"auto":this.opts.element.outerWidth(false)+"px"}return null}else if(e.isFunction(this.opts.width)){return this.opts.width()}else{return this.opts.width}}var r=n.call(this);if(r!==null){this.container.css("width",r)}}});i=_(r,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container"}).html(["<a href='javascript:void(0)' onclick='return false;' class='select2-choice' tabindex='-1'>","   <span></span><abbr class='select2-search-choice-close' style='display:none;'>×</abbr>","   <div><b></b></div>","</a>","<input class='select2-focusser select2-offscreen' type='text'/>","<div class='select2-drop' style='display:none'>","   <div class='select2-search'>","       <input type='text' autocomplete='off' class='select2-input'/>","   </div>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},disable:function(){if(!this.enabled)return;this.parent.disable.apply(this,arguments);this.focusser.attr("disabled","disabled")},enable:function(){if(this.enabled)return;this.parent.enable.apply(this,arguments);this.focusser.removeAttr("disabled")},opening:function(){this.parent.opening.apply(this,arguments);this.focusser.attr("disabled","disabled");this.opts.element.trigger(e.Event("open"))},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments);this.focusser.removeAttr("disabled");b(this.focusser)},focus:function(){if(this.opened()){this.close()}else{this.focusser.removeAttr("disabled");this.focusser.focus()}},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments);this.focusser.removeAttr("disabled");this.focusser.focus()},initContainer:function(){var e,t=this.container,r=this.dropdown,i=false;this.selection=e=t.find(".select2-choice");this.focusser=t.find(".select2-focusser");this.search.bind("keydown",this.bind(function(e){if(!this.enabled)return;if(e.which===n.PAGE_UP||e.which===n.PAGE_DOWN){w(e);return}switch(e.which){case n.UP:case n.DOWN:this.moveHighlight(e.which===n.UP?-1:1);w(e);return;case n.TAB:case n.ENTER:this.selectHighlighted();w(e);return;case n.ESC:this.cancel(e);w(e);return}}));this.focusser.bind("keydown",this.bind(function(e){if(!this.enabled)return;if(e.which===n.TAB||n.isControl(e)||n.isFunctionKey(e)||e.which===n.ESC){return}if(this.opts.openOnEnter===false&&e.which===n.ENTER){w(e);return}if(e.which==n.DOWN||e.which==n.UP||e.which==n.ENTER&&this.opts.openOnEnter){this.open();w(e);return}if(e.which==n.DELETE||e.which==n.BACKSPACE){if(this.opts.allowClear){this.clear()}w(e);return}}));d(this.focusser);this.focusser.bind("keyup-change input",this.bind(function(e){if(this.opened())return;this.open();this.search.val(this.focusser.val());this.focusser.val("");w(e)}));e.delegate("abbr","mousedown",this.bind(function(e){if(!this.enabled)return;this.clear();E(e);this.close();this.triggerChange();this.selection.focus()}));e.bind("mousedown",this.bind(function(e){i=true;if(this.opened()){this.close()}else if(this.enabled){this.open()}w(e);i=false}));r.bind("mousedown",this.bind(function(){this.search.focus()}));e.bind("focus",this.bind(function(e){w(e)}));this.focusser.bind("focus",this.bind(function(){this.container.addClass("select2-container-active")})).bind("blur",this.bind(function(){if(!this.opened()){this.container.removeClass("select2-container-active")}}));this.search.bind("focus",this.bind(function(){this.container.addClass("select2-container-active")}));this.setPlaceholder()},clear:function(){var e=this.selection.data("select2-data");this.opts.element.val("");this.selection.find("span").empty();this.selection.removeData("select2-data");this.setPlaceholder();this.opts.element.trigger({type:"removed",val:this.id(e),choice:e});this.triggerChange({removed:e})},initSelection:function(){var e;if(this.opts.element.val()===""&&this.opts.element.text()===""){this.close();this.setPlaceholder()}else{var n=this;this.opts.initSelection.call(null,this.opts.element,function(e){if(e!==t&&e!==null){n.updateSelection(e);n.close();n.setPlaceholder()}})}},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments);if(t.element.get(0).tagName.toLowerCase()==="select"){t.initSelection=function(t,n){var r=t.find(":selected");if(e.isFunction(n))n({id:r.attr("value")||r.text(),text:r.text(),element:r})}}else if("data"in t){t.initSelection=t.initSelection||function(n,r){var i=n.val();t.query({matcher:function(e,n,r){return c(i,t.id(r))},callback:!e.isFunction(r)?e.noop:function(e){r(e.results.length?e.results[0]:null)}})}}return t},setPlaceholder:function(){var e=this.getPlaceholder();if(this.opts.element.val()===""&&e!==t){if(this.select&&this.select.find("option:first").text()!=="")return;this.selection.find("span").html(this.opts.escapeMarkup(e));this.selection.addClass("select2-default");this.selection.find("abbr").hide()}},postprocessResults:function(t,n){var r=0,i=this,s=true;this.findHighlightableChoices().each2(function(e,t){if(c(i.id(t.data("select2-data")),i.opts.element.val())){r=e;return false}});this.highlight(r);if(n===true){s=this.showSearchInput=O(t.results)>=this.opts.minimumResultsForSearch;this.dropdown.find(".select2-search")[s?"removeClass":"addClass"]("select2-search-hidden");e(this.dropdown,this.container)[s?"addClass":"removeClass"]("select2-with-searchbox")}},onSelect:function(e,t){var n=this.opts.element.val();this.opts.element.val(this.id(e));this.updateSelection(e);this.opts.element.trigger({type:"selected",val:this.id(e),choice:e});this.close();if(!t||!t.noFocus)this.selection.focus();if(!c(n,this.id(e))){this.triggerChange()}},updateSelection:function(e){var n=this.selection.find("span"),r;this.selection.data("select2-data",e);n.empty();r=this.opts.formatSelection(e,n);if(r!==t){n.append(this.opts.escapeMarkup(r))}this.selection.removeClass("select2-default");if(this.opts.allowClear&&this.getPlaceholder()!==t){this.selection.find("abbr").show()}},val:function(){var e,n=false,r=null,i=this;if(arguments.length===0){return this.opts.element.val()}e=arguments[0];if(arguments.length>1){n=arguments[1]}if(this.select){this.select.val(e).find(":selected").each2(function(e,t){r={id:t.attr("value")||t.text(),text:t.text()};return false});this.updateSelection(r);this.setPlaceholder();if(n){this.triggerChange()}}else{if(this.opts.initSelection===t){throw new Error("cannot call val() if initSelection() is not defined")}if(!e&&e!==0){this.clear();if(n){this.triggerChange()}return}this.opts.element.val(e);this.opts.initSelection(this.opts.element,function(e){i.opts.element.val(!e?"":i.id(e));i.updateSelection(e);i.setPlaceholder();if(n){i.triggerChange()}})}},clearSearch:function(){this.search.val("");this.focusser.val("")},data:function(e){var n;if(arguments.length===0){n=this.selection.data("select2-data");if(n==t)n=null;return n}else{if(!e||e===""){this.clear()}else{this.opts.element.val(!e?"":this.id(e));this.updateSelection(e)}}}});s=_(r,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container select2-container-multi"}).html(["    <ul class='select2-choices'>","  <li class='select2-search-field'>","    <input type='text' autocomplete='off' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi' style='display:none;'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments);if(t.element.get(0).tagName.toLowerCase()==="select"){t.initSelection=function(e,t){var n=[];e.find(":selected").each2(function(e,t){n.push({id:t.attr("value")||t.text(),text:t.text(),element:t[0]})});t(n)}}else if("data"in t){t.initSelection=t.initSelection||function(n,r){var i=h(n.val(),t.separator);t.query({matcher:function(n,r,s){return e.grep(i,function(e){return c(e,t.id(s))}).length},callback:!e.isFunction(r)?e.noop:function(e){r(e.results)}})}}return t},initContainer:function(){var t=".select2-choices",r;this.searchContainer=this.container.find(".select2-search-field");this.selection=r=this.container.find(t);this.search.bind("input paste",this.bind(function(){if(!this.enabled)return;if(!this.opened()){this.open()}}));this.search.bind("keydown",this.bind(function(e){if(!this.enabled)return;if(e.which===n.BACKSPACE&&this.search.val()===""){this.close();var t,i=r.find(".select2-search-choice-focus");if(i.length>0){this.unselect(i.first());this.search.width(10);w(e);return}t=r.find(".select2-search-choice:not(.select2-locked)");if(t.length>0){t.last().addClass("select2-search-choice-focus")}}else{r.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")}if(this.opened()){switch(e.which){case n.UP:case n.DOWN:this.moveHighlight(e.which===n.UP?-1:1);w(e);return;case n.ENTER:case n.TAB:this.selectHighlighted();w(e);return;case n.ESC:this.cancel(e);w(e);return}}if(e.which===n.TAB||n.isControl(e)||n.isFunctionKey(e)||e.which===n.BACKSPACE||e.which===n.ESC){return}if(e.which===n.ENTER){if(this.opts.openOnEnter===false){return}else if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey){return}}this.open();if(e.which===n.PAGE_UP||e.which===n.PAGE_DOWN){w(e)}}));this.search.bind("keyup",this.bind(this.resizeSearch));this.search.bind("blur",this.bind(function(e){this.container.removeClass("select2-container-active");this.search.removeClass("select2-focused");if(!this.opened())this.clearSearch();e.stopImmediatePropagation()}));this.container.delegate(t,"mousedown",this.bind(function(t){if(!this.enabled)return;if(e(t.target).closest(".select2-search-choice").length>0){return}this.clearPlaceholder();this.open();this.focusSearch();t.preventDefault()}));this.container.delegate(t,"focus",this.bind(function(){if(!this.enabled)return;this.container.addClass("select2-container-active");this.dropdown.addClass("select2-drop-active");this.clearPlaceholder()}));this.clearSearch()},enable:function(){if(this.enabled)return;this.parent.enable.apply(this,arguments);this.search.removeAttr("disabled")},disable:function(){if(!this.enabled)return;this.parent.disable.apply(this,arguments);this.search.attr("disabled",true)},initSelection:function(){var e;if(this.opts.element.val()===""&&this.opts.element.text()===""){this.updateSelection([]);this.close();this.clearSearch()}if(this.select||this.opts.element.val()!==""){var n=this;this.opts.initSelection.call(null,this.opts.element,function(e){if(e!==t&&e!==null){n.updateSelection(e);n.close();n.clearSearch()}})}},clearSearch:function(){var e=this.getPlaceholder();if(e!==t&&this.getVal().length===0&&this.search.hasClass("select2-focused")===false){this.search.val(e).addClass("select2-default");this.resizeSearch()}else{this.search.val("").width(10)}},clearPlaceholder:function(){if(this.search.hasClass("select2-default")){this.search.val("").removeClass("select2-default")}},opening:function(){this.parent.opening.apply(this,arguments);this.clearPlaceholder();this.resizeSearch();this.focusSearch();this.opts.element.trigger(e.Event("open"))},close:function(){if(!this.opened())return;this.parent.close.apply(this,arguments)},focus:function(){this.close();this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(t){var n=[],r=[],i=this;e(t).each(function(){if(l(i.id(this),n)<0){n.push(i.id(this));r.push(this)}});t=r;this.selection.find(".select2-search-choice").remove();e(t).each(function(){i.addSelectedChoice(this)});i.postprocessResults()},tokenize:function(){var e=this.search.val();e=this.opts.tokenizer(e,this.data(),this.bind(this.onSelect),this.opts);if(e!=null&&e!=t){this.search.val(e);if(e.length>0){this.open()}}},onSelect:function(e,t){this.addSelectedChoice(e);this.opts.element.trigger({type:"selected",val:this.id(e),choice:e});if(this.select||!this.opts.closeOnSelect)this.postprocessResults();if(this.opts.closeOnSelect){this.close();this.search.width(10)}else{if(this.countSelectableResults()>0){this.search.width(10);this.resizeSearch();if(this.val().length>=this.getMaximumSelectionSize()){this.updateResults(true)}this.positionDropdown()}else{this.close();this.search.width(10)}}this.triggerChange({added:e});if(!t||!t.noFocus)this.focusSearch()},cancel:function(){this.close();this.focusSearch()},addSelectedChoice:function(n){var r=!n.locked,i=e("<li class='select2-search-choice'>"+"    <div></div>"+"    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'>×</a>"+"</li>"),s=e("<li class='select2-search-choice select2-locked'>"+"<div></div>"+"</li>");var o=r?i:s,u=this.id(n),a=this.getVal(),f;f=this.opts.formatSelection(n,o.find("div"));if(f!=t){o.find("div").replaceWith("<div>"+this.opts.escapeMarkup(f)+"</div>")}if(r){o.find(".select2-search-choice-close").bind("mousedown",w).bind("click dblclick",this.bind(function(t){if(!this.enabled)return;e(t.target).closest(".select2-search-choice").fadeOut("fast",this.bind(function(){this.unselect(e(t.target));this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");this.close();this.focusSearch()})).dequeue();w(t)})).bind("focus",this.bind(function(){if(!this.enabled)return;this.container.addClass("select2-container-active");this.dropdown.addClass("select2-drop-active")}))}o.data("select2-data",n);o.insertBefore(this.searchContainer);a.push(u);this.setVal(a)},unselect:function(e){var t=this.getVal(),n,r;e=e.closest(".select2-search-choice");if(e.length===0){throw"Invalid argument: "+e+". Must be .select2-search-choice"}n=e.data("select2-data");if(!n){return}r=l(this.id(n),t);if(r>=0){t.splice(r,1);this.setVal(t);if(this.select)this.postprocessResults()}e.remove();this.opts.element.trigger({type:"removed",val:this.id(n),choice:n});this.triggerChange({removed:n})},postprocessResults:function(){var e=this.getVal(),t=this.results.find(".select2-result"),n=this.results.find(".select2-result-with-children"),r=this;t.each2(function(t,n){var i=r.id(n.data("select2-data"));if(l(i,e)>=0){n.addClass("select2-selected");n.find(".select2-result-selectable").addClass("select2-selected")}});n.each2(function(e,t){if(!t.is(".select2-result-selectable")&&t.find(".select2-result-selectable:not(.select2-selected)").length===0){t.addClass("select2-selected")}});if(this.highlight()==-1){r.highlight(0)}},resizeSearch:function(){var e,t,n,r,i,s=p(this.search);e=S(this.search)+10;t=this.search.offset().left;n=this.selection.width();r=this.selection.offset().left;i=n-(t-r)-s;if(i<e){i=n-s}if(i<40){i=n-s}if(i<=0){i=e}this.search.width(i)},getVal:function(){var e;if(this.select){e=this.select.val();return e===null?[]:e}else{e=this.opts.element.val();return h(e,this.opts.separator)}},setVal:function(t){var n;if(this.select){this.select.val(t)}else{n=[];e(t).each(function(){if(l(this,n)<0)n.push(this)});this.opts.element.val(n.length===0?"":n.join(this.opts.separator))}},val:function(){var n,r=false,i=[],s=this;if(arguments.length===0){return this.getVal()}n=arguments[0];if(arguments.length>1){r=arguments[1]}if(!n&&n!==0){this.opts.element.val("");this.updateSelection([]);this.clearSearch();if(r){this.triggerChange()}return}this.setVal(n);if(this.select){this.opts.initSelection(this.select,this.bind(this.updateSelection));if(r){this.triggerChange()}}else{if(this.opts.initSelection===t){throw new Error("val() cannot be called if initSelection() is not defined")}this.opts.initSelection(this.opts.element,function(t){var n=e(t).map(s.id);s.setVal(n);s.updateSelection(t);s.clearSearch();if(r){s.triggerChange()}})}this.clearSearch()},onSortStart:function(){if(this.select){throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.")}this.search.width(0);this.searchContainer.hide()},onSortEnd:function(){var t=[],n=this;this.searchContainer.show();this.searchContainer.appendTo(this.searchContainer.parent());this.resizeSearch();this.selection.find(".select2-search-choice").each(function(){t.push(n.opts.id(e(this).data("select2-data")))});this.setVal(t);this.triggerChange()},data:function(t){var n=this,r;if(arguments.length===0){return this.selection.find(".select2-search-choice").map(function(){return e(this).data("select2-data")}).get()}else{if(!t){t=[]}r=e.map(t,function(e){return n.opts.id(e)});this.setVal(r);this.updateSelection(t);this.clearSearch()}}});e.fn.select2=function(){var n=Array.prototype.slice.call(arguments,0),r,o,u,a,f=["val","destroy","opened","open","close","focus","isFocused","container","onSortStart","onSortEnd","enable","disable","positionDropdown","data"];this.each(function(){if(n.length===0||typeof n[0]==="object"){r=n.length===0?{}:e.extend({},n[0]);r.element=e(this);if(r.element.get(0).tagName.toLowerCase()==="select"){a=r.element.attr("multiple")}else{a=r.multiple||false;if("tags"in r){r.multiple=a=true}}o=a?new s:new i;o.init(r)}else if(typeof n[0]==="string"){if(l(n[0],f)<0){throw"Unknown method: "+n[0]}u=t;o=e(this).data("select2");if(o===t)return;if(n[0]==="container"){u=o.container}else{u=o[n[0]].apply(o,n.slice(1))}if(u!==t){return false}}else{throw"Invalid arguments to select2 plugin: "+n}});return u===t?this:u};e.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:true,openOnEnter:true,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(e,t,n,r){var i=[];T(e.text,n.term,i,r);return i.join("")},formatSelection:function(e,n){return e?e.text:t},sortResults:function(e,t,n){return e},formatResultCssClass:function(e){return t},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(e,t){var n=t-e.length;return"Please enter "+n+" more character"+(n==1?"":"s")},formatInputTooLong:function(e,t){var n=e.length-t;return"Please enter "+n+" less character"+(n==1?"":"s")},formatSelectionTooBig:function(e){return"You can only select "+e+" item"+(e==1?"":"s")},formatLoadMore:function(e){return"Loading more results..."},formatSearching:function(){return"Searching..."},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(e){return e.id},matcher:function(e,t){return t.toUpperCase().indexOf(e.toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:M,escapeMarkup:function(e){var t={"\\":"&#92;","&":"&","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;","/":"&#47;"};return String(e).replace(/[&<>"'/\\]/g,function(e){return t[e[0]]})},blurOnChange:false,selectOnBlur:false,adaptContainerCssClass:function(e){return e},adaptDropdownCssClass:function(e){return null}};window.Select2={query:{ajax:N,local:C,tags:k},util:{debounce:m,markMatch:T},"class":{"abstract":r,single:i,multi:s}}})(jQuery)